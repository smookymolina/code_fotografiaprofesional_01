import app from './app'

const PORT = Number(process.env.PORT) || 3001

const server = app.listen(PORT, () => {
  console.log(`\nðŸŽ¯ Studio LumiÃ¨re API`)
  console.log(`ðŸš€ Servidor corriendo en http://localhost:${PORT}`)
  console.log(`ðŸŒ Ambiente: ${process.env.NODE_ENV || 'development'}`)
  console.log(`ðŸ“¡ Frontend: ${process.env.FRONTEND_URL || 'http://localhost:5173'}`)
  console.log(`ðŸ“‹ Health: http://localhost:${PORT}/api/health\n`)
})

process.on('SIGTERM', () => {
  console.log('SIGTERM recibido. Cerrando servidor...')
  server.close(() => {
    console.log('Servidor cerrado.')
    process.exit(0)
  })
})

process.on('unhandledRejection', (reason) => {
  console.error('Promesa rechazada sin manejar:', reason)
})

export default server
